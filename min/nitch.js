nitch={ready:function(a){if("complete"===document.readyState)return setTimeout(function(){nitch.device.ft();nitch.device.watchOrientation();a()},1);DOMContentLoaded=function(){document.removeEventListener("DOMContentLoaded",DOMContentLoaded,!1);nitch.device.ft();nitch.device.watchOrientation();a()};document.addEventListener("DOMContentLoaded",DOMContentLoaded,!1)},dom:function(a){return new nitch.nodeList(a)},nodeList:function(a){this.nodeList=Array.prototype.slice.call(document.querySelectorAll(a));
nitch.nodeList.prototype.find=function(a){this.nodeList=Array.prototype.slice.call(this.nodeList[0].querySelector(a));return this};nitch.nodeList.prototype.css=function(a){this.nodeList.forEach.call(this.nodeList,function(b){b.style.cssText=a});return this};nitch.nodeList.prototype.getStyle=function(a){return document.defaultView.getComputedStyle(this.nodeList[0],null).getPropertyValue(a)};nitch.nodeList.prototype.offset=function(){var a=this.nodeList[0].getBoundingClientRect();return{left:a.left+
window.pageXOffset,top:a.top+window.pageYOffset,width:a.width,height:a.height}};nitch.nodeList.prototype.text=function(a){if(!1===a)this.nodeList.forEach.call(this.nodeList,function(b){return b.textContent});else return this.nodeList.forEach.call(this.nodeList,function(b){b.textContent=a}),this};nitch.nodeList.prototype.each=[].forEach;nitch.nodeList.prototype.hasClass=function(a){this.each.call(this.nodeList,function(b){return b.classList.contains(a)});return this};nitch.nodeList.prototype.addClass=
function(a){this.each.call(this.nodeList,function(b){b.classList.add(a)});return this};nitch.nodeList.prototype.removeClass=function(a){this.each.call(this.nodeList,function(b){b.classList.remove(a)});return this};nitch.nodeList.prototype.toggleClass=function(a){this.each.call(this.nodeList,function(b){b.classList.toggle(a)});return this};nitch.nodeList.prototype.remove=function(){this.each.call(this.nodeList,function(a){a.parentNode.removeChild(a)});return this};nitch.nodeList.prototype.before=function(a){this.each.call(this.nodeList,
function(b){b.insertAdjacentHTML("beforebegin",a)});return this};nitch.nodeList.prototype.prepend=function(a){this.each.call(this.nodeList,function(b){b.insertAdjacentHTML("afterbegin",a)});return this};nitch.nodeList.prototype.after=function(a){this.each.call(this.nodeList,function(b){b.insertAdjacentHTML("afterend",a)});return this};nitch.nodeList.prototype.append=function(a){this.each.call(this.nodeList,function(b){b.insertAdjacentHTML("beforeend",a)});return this};nitch.nodeList.prototype.attr=
function(a,b){return b?(this.each.call(this.nodeList,function(d){d.setAttribute(a,b)}),this):this.nodeList[0].getAttribute(a)};nitch.nodeList.prototype.on=function(a,b){this.nodeList.forEach.call(this.nodeList,function(d){d.addEventListener(a,b,!1)});return this};nitch.nodeList.prototype.once=function(a,b){var d=this;this.on(a,function(){b();d.detach(a,b)})};nitch.nodeList.prototype.detach=function(a,b){console.info("calling detach");this.nodeList.forEach.call(this.nodeList,function(d){d.removeEventListener(a,
b,!1)});return this};nitch.nodeList.prototype.fire=function(a){this.eventStore||(this.eventStore={});if(!this.eventStore[a]){var b=document.createEvent("CustomEvent");b.initEvent(a,!0,!0);this.eventStore[a]=b}this.nodeList[0].dispatchEvent(this.eventStore[a]);return this};nitch.nodeList.prototype.tap=function(a){var b="undefined"===typeof window.ontouchstart?!1:!0,d,e,f;preventGhostClick=function(a,b){var c=Date.now();if("touchstart"==a.type)d=a.touches[0].clientX,e=a.touches[0].clientY;else{if("touchend"==
a.type)return f=c,b(a),a.preventDefault(),a.stopPropagation(),a;var c=c-f,k=Math.abs(a.clientX-d),i=Math.abs(a.clientY-e);if(500>c||1500>c&&25>k&&25>i)return b(a),a;a.preventDefault();a.stopPropagation()}};b?(this.on("touchstart",function(a){preventGhostClick(a)}),this.on("touchend",function(b){preventGhostClick(b,a)}),this.on("click",function(b){preventGhostClick(b,a)})):(this.on("click",function(b){a(b)}),this.on("keydown",function(b){32==b.keyCode&&a(b)}));return this};nitch.nodeList.prototype.touchandhold=
function(a,b){if(a){var d="undefined"===typeof window.ontouchstart?!1:!0,e=nitch.util.apply({start:function(){},move:function(){},release:function(){}},b),f=nitch.dom(a);d?(f.on("touchstart",function(a){e.start(a);window.addEventListener("touchmove",e.move,!1)}),f.on("touchend",function(a){e.release(a);window.removeEventListener("touchmove",e.move,!1)}),this.on("click",function(){})):(f.on("mousedown",function(a){e.start(a);window.addEventListener("mousemove",e.move,!1)}),f.on("mouseup",function(a){e.release(a);
window.removeEventListener("mousemove",e.move,!1)}));return this}};return this},events:{visibly:function(a){var c,b,d;if("undefined"!==typeof document.hidden)c="hidden",b="visible",d="visibilitychange";else if("undefined"!==typeof document.mozHidden)c="mozHidden",b="mozVisible",d="mozvisibilitychange";else if("undefined"!==typeof document.msHidden)c="msHidden",b="msVisible",d="msvisibilitychange";else if("undefined"!==typeof document.webkitHidden)c="webkitHidden",b="webkitVisible",d="webkitvisibilitychange";
else if("undefined"!==typeof document.oHidden)c="oHidden",b="oVisible",d="ovisibilitychange";else return;visibilityCallback=function(){if(document[c])e.onHidden(b);else if(document[b])e.onVisible()};var e=nitch.util.apply({onVisible:function(){},onHidden:function(){}},a);document.addEventListener(d,visibilityCallback,!1)}},util:{apply:function(a,c){var a=a||{},c=c||{},b;for(b in c)c.hasOwnProperty(b)&&(a[b]=c[b]);return a},delay:function(a,c){return setTimeout(function(){return c.apply(null,[])},
a)},defer:function(a){return util.delay.apply(nitch,[a,1].concat(slice.call(arguments,1)))}}};nitch.device={mediaQueries:{ipad3:"only screen and (min-width: 768px) and (max-width: 1024px) and (-webkit-device-pixel-ratio: 2)",ipad2:"only screen and (min-width: 768px) and (max-width: 1024px)",iphone4s:"only screen and (min-device-width : 640px) and (max-device-width : 960px) and (-webkit-device-pixel-ratio: 2)",iphone4:"only screen and (min-device-width : 640px) and (max-device-width : 960px)",iphone3:"only screen and (min-device-width : 320px) and (max-device-width : 480px)"},type:function(){var a=
window.navigator.userAgent;return a.match(/GoogleTV|SmartTV|Internet.TV|NetCast|NETTV|AppleTV|boxee|Kylo|Roku|DLNADOC|CE\-HTML/i)?"tv":a.match(/Xbox|PLAYSTATION.3|Wii/i)?"tv":a.match(/iPad/i)||a.match(/tablet/i)&&!a.match(/RX-34/i)||a.match(/FOLIO/i)?"tablet":a.match(/Linux/i)&&a.match(/Android/i)&&!a.match(/Fennec|mobi|HTC.Magic|HTCX06HT|Nexus.One|SC-02B|fone.945/i)?"tablet":a.match(/Kindle/i)||a.match(/Mac.OS/i)&&a.match(/Silk/i)?"tablet":a.match(/GT-P10|SC-01C|SHW-M180S|SGH-T849|SCH-I800|SHW-M180L|SPH-P100|SGH-I987|zt180|HTC(.Flyer|\_Flyer)|Sprint.ATP51|ViewPad7|pandigital(sprnova|nova)|Ideos.S7|Dell.Streak.7|Advent.Vega|A101IT|A70BHT|MID7015|Next2|nook/i)||
a.match(/MB511/i)&&a.match(/RUTEM/i)?"tablet":a.match(/BOLT|Fennec|Iris|Maemo|Minimo|Mobi|mowser|NetFront|Novarra|Prism|RX-34|Skyfire|Tear|XV6875|XV6975|Google.Wireless.Transcoder/i)?"mobile":a.match(/Opera/i)&&a.match(/Windows.NT.5/i)&&a.match(/HTC|Xda|Mini|Vario|SAMSUNG\-GT\-i8000|SAMSUNG\-SGH\-i9/i)?"mobile":a.match(/Windows.(NT|XP|ME|9)/)&&!a.match(/Phone/i)||a.match(/Win(9|.9|NT)/i)?"desktop":a.match(/Macintosh|PowerPC/i)&&!a.match(/Silk/i)?"desktop":a.match(/Linux/i)&&a.match(/X11/i)?"desktop":
a.match(/Solaris|SunOS|BSD/i)?"desktop":a.match(/Bot|Crawler|Spider|Yahoo|ia_archiver|Covario-IDS|findlinks|DataparkSearch|larbin|Mediapartners-Google|NG-Search|Snappy|Teoma|Jeeves|TinEye/i)&&!a.match(/Mobile/i)?"desktop":"mobile"},featureList:function(a){var c='<ul id="nitch-device-features">',b;for(b in nitch.device.features)c+="<li><strong>"+b+":</strong> "+nitch.device.features[b]+"</li>";nitch.dom(a).after(c+"</ul>")},ft:function(){var a=new Audio;this.features={onLine:"undefined"===typeof navigator.onLine?
!1:navigator.onLine,localStorage:"undefined"===typeof window.localStorage?!1:!0,appCache:"undefined"===typeof window.applicationCache?!1:!0,sessionStorage:"undefined"===typeof window.sessionStorage?!1:!0,geoLocation:"undefined"===typeof navigator.geolocation?!1:!0,audioOgg:a.canPlayType('audio/ogg; codecs="vorbis"'),audioMp3:a.canPlayType('audio/mpeg; codecs="mp3"'),audioAcc:a.canPlayType('audio/mp4; codecs="mp4a.40.2"'),audioWav:a.canPlayType('audio/wav; codecs="1"'),pixelRatio:window.devicePixelRatio?
window.devicePixelRatio:1,mouse:"undefined"===typeof window.onmousedown?!1:!0,touch:"undefined"===typeof window.ontouchstart?!1:!0,screenHeight:screen.height,screenWidth:screen.width,windowWidth:window.innerWidth||document.body.offsetWidth||0,windowHeight:window.innerHeight||document.body.offsetHeight||0,orientation:"undefined"===typeof window.orientation?!1:window.orientation,isFullScreen:"undefined"===typeof navigator.standalone?!1:!0,DeviceOrientationEvent:"undefined"===typeof window.DeviceOrientationEvent?
!1:!0,OrientationEvent:"undefined"===typeof window.OrientationEvent?!1:!0,audioElement:"undefined"===typeof window.Audio?!1:!0,videoElement:"undefined"===typeof window.Video?!1:!0,webGL:"undefined"===typeof window.WebGLRenderingContext?!1:!0}},watchOrientation:function(){nitch.watchit=function(){var a=window.orientation;90==a||-90==a?(nitch.dom("body").removeClass("portrait"),nitch.dom("body").addClass("landscape")):(nitch.dom("body").removeClass("landscape"),nitch.dom("body").addClass("portrait"))};
nitch.watchit();window.addEventListener("orientationchange",nitch.watchit,!1)},stylesheet:function(a){if(a){nitch.device.stylesheet.prototype.add=function(a,b){nitch.dom("head").append('<link type="text/css" rel="stylesheet" media="'+b+'" href="'+a+'" />')};var c=nitch.device.type(),b;for(b in a)if("tv"==b&&"tv"==c)this.add(a[b],"");else if("desktop"==b&&"desktop"==c){this.add(a[b],"");break}else if(window.matchMedia(nitch.device.mediaQueries[b]).matches){this.add(a[b],nitch.device.mediaQueries[b]);
break}}},appcache:function(a){if(window.applicationCache&&a){var c=nitch.device.type(),b;for(b in a)if("tv"==b&&"tv"==c)nitch.dom("html").attr("manifest",a[b]);else if("desktop"==b&&"desktop"==c){nitch.dom("html").attr("manifest",a[b]);break}else if(window.matchMedia(nitch.device.mediaQueries[css]).matches){nitch.dom("html").attr("manifest",a[b]);break}}}};nitch.math={rng:function(){},Alea:function(){return function(a){var c=0,b=0,d=0,e=1;0===a.length&&(a=[+new Date]);for(var f=nitch.math.Mash(),c=f(" "),b=f(" "),d=f(" "),h=0;h<a.length;h++)c-=f(a[h]),0>c&&(c+=1),b-=f(a[h]),0>b&&(b+=1),d-=f(a[h]),0>d&&(d+=1);var f=null,g=function(){var a=2091639*c+2.3283064365386963E-10*e;c=b;b=d;return d=a-(e=a|0)};g.uint32=function(){return 4294967296*g()};g.fract53=function(){return g()+1.1102230246251565E-16*(2097152*g()|0)};g.version="Alea 0.9";g.args=a;return g}(Array.prototype.slice.call(arguments))},
Mash:function(){var a=4022871197,c=function(b){for(var b=b.toString(),c=0;c<b.length;c++){a+=b.charCodeAt(c);var e=0.02519603282416938*a;a=e>>>0;e-=a;e*=a;a=e>>>0;e-=a;a+=4294967296*e}return 2.3283064365386963E-10*(a>>>0)};c.version="Mash 0.9";return c},deg2rad:function(a){return a*(Math.PI/180)},rad2deg:function(a){return a*(180/Math.PI)},distance:function(a,c){var b=nitch.math.distanceSquared(a,c);return Math.sqrt(parseFloat(b))},distanceSquared:function(a,c){return(a.x-c.x)*(a.x-c.x)+(a.y-c.y)*
(a.y-c.y)},within:function(a,c,b){return a>=c&&a<=b}};nitch.array={shuffle:function(a,c){var b=a.length,d,e;for(c||(c=Math);--b;)d=c.random()*(b+1)|0,e=a[b],a[b]=a[d],a[d]=e;return a},pushRand:function(a,c,b){b=(b||Math).random()*(a.length+1)|0;a.push(a[b]);a[b]=c;return a.length}};nitch.math.rng.random=function(){nitch.math.rng.generator||(nitch.math.rng.generator=nitch.math.Alea());return nitch.math.rng.generator()};nitch.modal=function(a,c){this.visiblity="hidden";var b=nitch.util.apply({ariaProp:"polite",ariaRole:"dialog",maskClose:!0},c);this.mask=nitch.dom("#nitch-modal-backdrop");this.elem=nitch.dom(a);if(!a||0===this.elem.nodeList.length)throw TypeError("No element supplied or found");this.mask.nodeList[0]||(nitch.dom("body").append('<div id="nitch-modal-backdrop"></div>'),this.mask=nitch.dom("#nitch-modal-backdrop"));if(b.maskClose){var d=this;nitch.dom("#nitch-modal-backdrop").on("click",function(){d.hide()})}this.elem.attr("aria-live",
b.ariaProp).attr("role",b.ariaRole);nitch.modal.prototype.show=function(){this.elem.fire("show");this.mask.getStyle("display")=="none"&&this.mask.css("display:block");this.elem.css("display:block");this.elem.fire("shown");this.visiblity="shown"};nitch.modal.prototype.hide=function(){this.elem.fire("hide");this.mask.css("display:none");this.elem.css("display:none");this.elem.fire("hidden");this.visiblity="hidden"};nitch.modal.prototype.toggle=function(){this.elem.getStyle("display")=="block"?this.hide():
this.show()}};nitch.stats=function(a){this.defaults={engine:"google"};if(_gaq){localStorage.getItem("nitch.stats")||localStorage.setItem("nitch.stats","[]");if(a&&a.link){var c=this;nitch.dom(a.link).tap(function(a){a.preventDefault();a=nitch.dom(this).attr("data-category");c.link(a,this)})}nitch.stats.prototype.event=function(a,c){this.defaults.online?_gaq.push(["_trackEvent",a,c]):this.storeLocalEvents(["_trackEvent",a,c])};nitch.stats.prototype.link=function(a,c){var e=c.href,e=e.split("/")[2];this.event(a,
e);this.defaults.online&&setTimeout('document.location = "'+c.href+'"',100)};storeLocalEvents=function(a){var c=JSON.parse(localStorage.getItem("nitch.stats"));c.push(a);localStorage.setItem("offlineGA",JSON.stringify(c))};sendLocalEvents=function(){_gaq.push(JSON.parse(localStorage.getItem("nitch.stats")));localStorage.setItem("nitch.stats","[]")};this.defaults.online="undefined"===typeof navigator.onLine?!1:navigator.onLine;c=this;document.body.addEventListener("offline",function(){c.defaults.online=
!1},!1);document.body.addEventListener("online",function(){c.defaults.online=!0;c.sendLocalEvents()},!1)}};nitch.xhr=function(a,c){this.opts=nitch.util.apply({method:"get",async:!0,callback:function(){},error:function(){},params:null},c);var b=this,d=new XMLHttpRequest,e;d.queryString=this.opts.params;d.open(this.opts.method,a,this.opts.async);d.setRequestHeader("X-Requested-With","XMLHttpRequest");"post"==this.opts.method.toLowerCase()&&d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(e in this.opts.headers)this.opts.headers.hasOwnProperty(e)&&d.setRequestHeader(e,this.opts.headers[e]);
d.handleResp=this.opts.callback;d.handleError=this.opts.error;e=function(){4==d.readyState&&(delete b.xmlHttpRequest,/^[20]/.test(d.status)&&d.handleResp(),/^[45]/.test(d.status)&&d.handleError())};this.opts.async&&(d.onreadystatechange=e,this.xmlHttpRequest=d);d.send(this.opts.params);this.opts.async||e();nitch.xhr.prototype.json=function(){return JSON.parse(d.responseText)};nitch.xhr.prototype.xml=function(){return(new DOMParser).parseFromString(d.responseXml,"text/xml")}};nitch.progress=function(a,c){if(!a||0===nitch.dom(a).nodeList.length)throw TypeError("No element supplied");var b=nitch.util.apply({defaultLoaded:0,assets:{},onComplete:function(){}},c),d=this.totalLoaded=b.defaultLoaded,e;for(e in b.assets)d+="number"===typeof b.assets[e]?b.assets[e]:0;this.total=d;nitch.dom(a).after('<div id="nitch-progress" class="progress" role="progressbar" aria-valuenow="'+b.defaultLoaded+'" aria-valuemin="'+b.defaultLoaded+'" aria-valuemax="'+this.total+'"><div style="width: '+
b.defaultLoaded+'%;" class="bar"></div></div>');nitch.progress.prototype.loaded=function(a){if(b.assets[a]&&(this.totalLoaded+=b.assets[a],b.assets[a]=0,nitch.dom("#nitch-progress").attr("aria-valuenow",this.totalLoaded),nitch.dom("#nitch-progress .bar").css("width:"+this.totalLoaded+"%;"),this.totalLoaded>=this.total))b.onComplete()};nitch.progress.prototype.failed=function(c){b.onComplete=function(){};this.totalLoaded=this.total;nitch.dom("#nitch-progress").remove();nitch.dom(a).after('<div id="nitch-progress-error">'+
c+"</div>")};if(this.totalLoaded>=this.total)b.onComplete()};nitch.statemachine=function(a){this.defaults={results:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,ASYNC:4},errors:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async"};var c="string"==typeof a.initial?{state:a.initial}:a.initial,b={},d=a.events||[],e=a.callbacks||{},f={};nitch.statemachine.prototype.doCallback=function(a,b,c,e,d,f){if(b)try{return b.apply(a,[c,e,d].concat(f))}catch(i){return a.error(c,e,d,f,this.defaults.errors.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",
i)}};nitch.statemachine.prototype.beforeEvent=function(a,b,c,e,d){return this.doCallback(a,a["onBefore"+b],b,c,e,d)};nitch.statemachine.prototype.afterEvent=function(a,b,c,e,d){return this.doCallback(a,a["onAfter"+b]||a["on"+b],b,c,e,d)};nitch.statemachine.prototype.leaveState=function(a,b,c,e,d){return this.doCallback(a,a["onLeave"+c],b,c,e,d)};nitch.statemachine.prototype.enterState=function(a,b,c,e,d){return this.doCallback(a,a["onEnter"+e]||a["on"+e],b,c,e,d)};nitch.statemachine.prototype.changeState=
function(a,b,c,e,d){return this.doCallback(a,a.onChangeState,b,c,e,d)};nitch.statemachine.prototype.buildEvent=function(a,b,c){return function(){var e=this.current,d=b[e]||b[c.defaults.WILDCARD]||e,f=Array.prototype.slice.call(arguments);if(this.transition)return this.error(a,e,d,f,c.defaults.errors.PENDING_TRANSITION,"event "+a+" inappropriate because previous transition did not complete");if(this.cannot(a))return this.error(a,e,d,f,c.defaults.errors.INVALID_TRANSITION,"event "+a+" inappropriate in current state "+
this.current);if(!1===c.beforeEvent(this,a,e,d,f))return c.defaults.results.CANCELLED;if(e===d)return c.afterEvent(this,a,e,d,f),c.defaults.results.NOTRANSITION;var i=this;this.transition=function(){i.transition=null;i.current=d;c.enterState(i,a,e,d,f);c.changeState(i,a,e,d,f);c.afterEvent(i,a,e,d,f)};this.transition.cancel=function(){i.transition=null;c.afterEvent(i,a,e,d,f)};var g=c.leaveState(this,a,e,d,f);if(!1===g)return this.transition=null,c.defaults.results.CANCELLED;if("async"===g)return c.defaults.ASYNC;
if(this.transition)return this.transition(),c.defaults.results.SUCCEEDED}};var h=function(a){var b=a.from instanceof Array?a.from:a.from?[a.from]:[this.defaults.WILDCARD];f[a.name]=f[a.name]||{};for(var c=0;c<b.length;c++)f[a.name][b[c]]=a.to||b[c]};c&&(c.event=c.event||"startup",h({name:c.event,from:"none",to:c.state}));for(var g=0;g<d.length;g++)h(d[g]);var j=this,k;for(k in f)f.hasOwnProperty(k)&&(b[k]=this.buildEvent(k,f[k],j));for(var i in e)e.hasOwnProperty(i)&&(b[i]=e[i]);b.current="none";
b.is=function(a){return this.current==a};b.can=function(a){return!this.transition&&(f[a].hasOwnProperty(this.current)||f[a].hasOwnProperty(j.defaults.WILDCARD))};b.cannot=function(a){return!this.can(a)};b.error=a.error||function(a,b,c,e,d,f,i){throw i||f;};if(c&&!c.defer)return b[c.event](),b};nitch.collision={AABB:function(a,c){var b=(a.width+c.width)/2,d=(a.height+c.height)/2,e=a.x+a.width/2-(c.x+c.width/2),f=a.y+a.height/2-(c.y+c.height/2);if(Math.abs(e)<=b&&Math.abs(f)<=d){var h=b*f,g=d*e;dir=h>g?h>-g?"top":"left":h>-g?"right":"bottom";b-=0>e?-e:e;d-=0>f?-f:f;return{dir:dir,pv:[0>e?-b:b,0>f?-d:d]}}return!1}};nitch.loop=function(a){if(!a)throw TypeError("A game loop is required");var c=this.running=!1;this.progress=this.startTime=!1;this.resumed=this.paused=0;var b,d=this;this.loop=function(){if(d.running){var b=(new Date).getTime();d.progress=b-d.startTime;a();d.looper=window.requestAnimationFrame(d.loop)}};nitch.loop.prototype.start=function(a){if(c)throw TypeError("Loop has already been started");a&&a();this.startTime=window.animationStartTime;b=window.requestAnimationFrame(this.loop);c=this.running=
!0};nitch.loop.prototype.pause=function(a){if(!c)throw TypeError("Loop hasn't been started");if(!this.running)throw TypeError("Loop isn't running");window.cancelAnimationFrame(b);this.running=!1;this.paused++;a&&a()};nitch.loop.prototype.resume=function(a){if(!c)throw TypeError("Loop hasn't been started");if(this.running)throw TypeError("Loop is already running");a&&a();b=window.requestAnimationFrame(this.loop);this.running=!0;this.resumed++};nitch.loop.prototype.end=function(a){if(!c)throw TypeError("Loop hasn't been started");
if(!this.running)throw TypeError("Loop isn't running");window.cancelAnimationFrame(b);this.running=!1;a&&a();c=!1}};
(function(){for(var a=0,c=["ms","moz","webkit","o"],b=0;b<c.length&&!window.requestAnimationFrame;++b)window.requestAnimationFrame=window[c[b]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[b]+"CancelAnimationFrame"]||window[c[b]+"CancelRequestAnimationFrame"];window.animationStartTime||(window.animationStartTime=window.msAnimationStartTime||window.mozAnimationStartTime||window.webkitAnimationStartTime||window.oAnimationStartTime||(new Date).getTime());window.requestAnimationFrame||
(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),f=Math.max(0,16-(c-a)),h=window.setTimeout(function(){b(c+f)},f);a=c+f;return h});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})})();nitch.debug={performance:function(a){options=nitch.util.apply({fps:58,top:0,left:0},a);this.frames=0;this.timeLastSecond=this.timeLastFrame=this.time=Date.now();this.fps=0;this.fpsMin=1E3;this.ms=this.fpsMax=0;this.msMin=1E3;this.msMax=0;a='<div id="performance" style="top:'+options.top+"px;left:"+options.left+'px">';nitch.dom("body").append(a+'<p><strong>FPS:</strong> <span id="per-fps"></span></p><p><strong>MS:</strong> <span id="per-ms"></span></p></div>');nitch.debug.performance.prototype.update=
function(){nitch.dom("#per-ms").text(this.msInfo());nitch.dom("#per-fps").text(this.fpsInfo())};nitch.debug.performance.prototype.msInfo=function(){this.time=Date.now();this.ms=this.time-this.timeLastFrame;this.msMin=Math.min(this.msMin,this.ms);this.msMax=Math.max(this.msMax,this.ms);this.timeLastFrame=this.time;this.frames++;return this.ms+" (min: "+this.msMin+", max: "+this.msMax+")"};nitch.debug.performance.prototype.fpsInfo=function(){this.fps=Math.round(1E3*this.frames/(this.time-this.timeLastSecond));
this.fpsMin=Math.min(this.fpsMin,this.fps);this.fpsMax=Math.max(this.fpsMax,this.fps);this.timeLastSecond=this.time;this.frames=0;return this.fps+" (min: "+this.fpsMin+", max: "+this.fpsMax+")"};var c=this;setInterval(function(){c.update()},1E3/options.fps)},timing:function(a){window.performance=window.performance||window.mozPerformance||window.msPerformance||window.webkitPerformance||{};var c=performance.timing||{},b=performance.navigation||{};c.legacyNavigationStart=(new Date).getTime();var d={unloadEventEnd:"Last page unloaded ",
legacyNavigationStart:"Legacy navigation started ~",loadEventEnd:"Page loaded "},e={redirectStart:"Redirects",fetchStart:"Fetch",domainLookupStart:"DNS",connectStart:"Connect",requestStart:"Request",responseStart:"Response",loadEventStart:"Load event"};if(!c.navigationStart)return!1;percentage=function(a){var b=c.navigationStart;return Math.round(100*(c[a]-b)/(c.loadEventEnd-b))};milliseconds=function(a,b){var d=c[a],e=c[b];return!d||!e?"n/a":e-d+"ms"};loadSection=function(a){return'<div class="navSection" id="nitch-'+
a+'" style="width:'+percentage(a)+'%">'+d[a]+milliseconds("navigationStart",a)+"</div>"};loadBar=function(a,b){var c=percentage(a),d=percentage(b)-c;return'<div class="navBar" id="nitch-'+a+'" style="width:'+(0<d?d+"%":"1px")+"; margin-left:"+(0<c?c:0)+'%">'+e[a]+" "+milliseconds(a,b)+"</div>"};if(!0===a.list){for(var f='<div id="nitch-timing-list"><dl><dt>Navigation</dt>',h=["TYPE_NAVIGATE","TYPE_RELOAD","TYPE_BACK_FORWARD"],g=0;g<h.length;g++)f+="<dd><strong>"+h[g]+"</strong>: "+b[h[g]]+"</dd>";
var f=f+"<dt>Timing</dt>",j;for(j in c)f+="<dd><strong>"+j+"</strong>: "+c[j]+"</dd>";nitch.dom("body").after(f+"</dl></div>")}a.timeline&&(b='<div id="nitch-timeline"><div class="navSection" id="nitch-navigationStart">Navigation started 0ms</div>'+loadSection("unloadEventEnd"),b+=loadSection("legacyNavigationStart"),b+=loadSection("loadEventEnd"),b+=loadBar("redirectStart","redirectEnd"),b+=loadBar("fetchStart","responseEnd"),b+=loadBar("domainLookupStart","domainLookupEnd"),b+=loadBar("connectStart",
"connectEnd"),b+=loadBar("requestStart","responseStart"),b+=loadBar("responseStart","responseEnd"),b+=loadBar("loadEventStart","loadEventEnd"),nitch.dom(a.timeline).append(b+"</div>"))},screensafe:function(){}};"undefined"!==typeof document&&!("classList"in document.createElement("a"))&&function(a){var a=(a.HTMLElement||a.Element).prototype,c=Object,b=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},d=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},e=function(a,b){this.name=a;this.code=DOMException[a];this.message=b},f=function(a,b){if(""===b)throw new e("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(b))throw new e("INVALID_CHARACTER_ERR",
"String contains an invalid character");return d.call(a,b)},h=function(a){for(var c=b.call(a.className),c=c?c.split(/\s+/):[],d=0,e=c.length;d<e;d++)this.push(c[d]);this._updateClassName=function(){a.className=this.toString()}},g=h.prototype=[],j=function(){return new h(this)};e.prototype=Error.prototype;g.item=function(a){return this[a]||null};g.contains=function(a){return-1!==f(this,a+"")};g.add=function(a){a+="";-1===f(this,a)&&(this.push(a),this._updateClassName())};g.remove=function(a){a=f(this,
a+"");-1!==a&&(this.splice(a,1),this._updateClassName())};g.toggle=function(a){a+="";-1===f(this,a)?this.add(a):this.remove(a)};g.toString=function(){return this.join(" ")};if(c.defineProperty){g={get:j,enumerable:!0,configurable:!0};try{c.defineProperty(a,"classList",g)}catch(k){-2146823252===k.number&&(g.enumerable=!1,c.defineProperty(a,"classList",g))}}else c.prototype.__defineGetter__&&a.__defineGetter__("classList",j)}(self);window.matchMedia=window.matchMedia||function(a){var c,b=a.documentElement,d=b.firstElementChild||b.firstChild,e=a.createElement("body"),f=a.createElement("div");f.id="mq-test-1";f.style.cssText="position:absolute;top:-100em";e.style.background="none";e.appendChild(f);return function(a){f.innerHTML='&shy;<style media="'+a+'"> #mq-test-1 { width: 42px; }</style>';b.insertBefore(e,d);c=42===f.offsetWidth;b.removeChild(e);return{matches:c,media:a}}}(document);
